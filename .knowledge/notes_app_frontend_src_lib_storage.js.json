{"is_source_file": true, "format": "JavaScript", "description": "This file contains helper functions for managing notes and notebooks using localStorage in a web application. It includes functions for creating, renaming, deleting, listing, and updating notes and notebooks, as well as importing/exporting data. The code handles data normalization, schema validation, and migration logic for persistent client-side storage.", "external_files": ["crypto (built-in Web Crypto API)"], "external_methods": ["window.localStorage.getItem", "window.localStorage.setItem"], "published": ["getSelectedNotebookId", "setSelectedNotebookId", "listNotebooks", "createNotebook", "renameNotebook", "deleteNotebook", "listNotes", "listActiveNotes", "listArchivedNotes", "createNote", "updateNote", "archiveNote", "unarchiveNote", "deleteNotePermanently", "deleteNote", "getAllTags", "exportAllData", "importAllData"], "classes": [], "methods": [{"name": "getSelectedNotebookId()", "description": "Returns the ID of the currently selected notebook from localStorage or an empty string if none.", "scope": "", "scopeKind": ""}, {"name": "setSelectedNotebookId(id)", "description": "Stores the specified notebook ID in localStorage.", "scope": "", "scopeKind": ""}, {"name": "listNotebooks()", "description": "Retrieves the list of notebooks, creating a default if none exist.", "scope": "", "scopeKind": ""}, {"name": "createNotebook(name)", "description": "Creates and stores a new notebook with the specified name.", "scope": "", "scopeKind": ""}, {"name": "renameNotebook(id, name)", "description": "Renames an existing notebook identified by ID.", "scope": "", "scopeKind": ""}, {"name": "deleteNotebook(id)", "description": "Removes a notebook and all associated notes.", "scope": "", "scopeKind": ""}, {"name": "listNotes(notebookId)", "description": "Returns notes for a specified notebook or all notes if no ID is provided.", "scope": "", "scopeKind": ""}, {"name": "listActiveNotes(notebookId)", "description": "Returns all non-archived notes, optionally filtered by notebook.", "scope": "", "scopeKind": ""}, {"name": "listArchivedNotes(notebookId)", "description": "Returns all archived notes, optionally filtered by notebook.", "scope": "", "scopeKind": ""}, {"name": "createNote(notePayload, notebookId)", "description": "Creates a new note with provided data and associates it with a notebook.", "scope": "", "scopeKind": ""}, {"name": "updateNote(id, patch)", "description": "Updates an existing note based on ID and patch data.", "scope": "", "scopeKind": ""}, {"name": "archiveNote(id)", "description": "Marks a note as archived.", "scope": "", "scopeKind": ""}, {"name": "unarchiveNote(id)", "description": "Removes the archived status from a note.", "scope": "", "scopeKind": ""}, {"name": "deleteNotePermanently(id)", "description": "Deletes a note permanently from storage.", "scope": "", "scopeKind": ""}, {"name": "deleteNote(id)", "description": "Archives a note to simulate deletion (backward compatibility).", "scope": "", "scopeKind": ""}, {"name": "getAllTags(notes)", "description": "Returns a sorted list of unique tags from a set of notes.", "scope": "", "scopeKind": ""}, {"name": "exportAllData()", "description": "Exports all notebooks and notes into a schema-validated JSON object.", "scope": "", "scopeKind": ""}, {"name": "importAllData(json, { mode = 'merge' } = {})", "description": "Imports data from a JSON backup, merging or replacing existing data, and validates schema.", "scope": "", "scopeKind": ""}, {"name": "ensureDefaultNotebook()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "mergeData(existing, incoming)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "normalizeNote(n)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "normalizeNotebook(n)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "readJSON(key, fallback)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "validateImportSchema(json)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "writeJSON(key, value)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["window.localStorage.getItem", "window.localStorage.setItem", "readJSON", "writeJSON", "normalizeNote", "normalizeNotebook", "ensureDefaultNotebook", "setSelectedNotebookId", "getSelectedNotebookId"], "search-terms": ["localStorage helpers", "note and notebook normalization", "dynamic ID generation", "schema validation", "import/export", "merging datasets", "note archiving"], "state": 2, "file_id": 24, "knowledge_revision": 143, "git_revision": "", "revision_history": [{"120": ""}, {"123": ""}, {"126": ""}, {"129": ""}, {"130": ""}, {"131": ""}, {"139": ""}, {"140": ""}, {"141": ""}, {"142": ""}, {"143": ""}], "ctags": [{"_type": "tag", "name": "EXPORT_SCHEMA_VERSION", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^const EXPORT_SCHEMA_VERSION = 2; \\/\\/ bump due to adding \"pinned\" field to notes$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "NOTEBOOKS_KEY", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^const NOTEBOOKS_KEY = 'notes_app_notebooks_v1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "NOTES_KEY", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^const NOTES_KEY = 'notes_app_data_v1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "SELECTED_NOTEBOOK_KEY", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^const SELECTED_NOTEBOOK_KEY = 'notes_app_selected_notebook_v1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "archiveNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function archiveNote(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "createNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function createNote(notePayload, notebookId) {$/", "language": "JavaScript", "kind": "function", "signature": "(notePayload, notebookId)"}, {"_type": "tag", "name": "createNotebook", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function createNotebook(name) {$/", "language": "JavaScript", "kind": "function", "signature": "(name)"}, {"_type": "tag", "name": "createdAt", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    createdAt: new Date().toISOString(),$/", "language": "JavaScript", "kind": "property", "scope": "createNotebook.nb", "scopeKind": "class"}, {"_type": "tag", "name": "deleteNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function deleteNote(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "deleteNotePermanently", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function deleteNotePermanently(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "deleteNotebook", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function deleteNotebook(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "ensureDefaultNotebook", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^function ensureDefaultNotebook() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "exportAllData", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function exportAllData() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "exportedAt", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    exportedAt: new Date().toISOString(),$/", "language": "JavaScript", "kind": "property", "scope": "exportAllData.payload", "scopeKind": "class"}, {"_type": "tag", "name": "getAllTags", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function getAllTags(notes) {$/", "language": "JavaScript", "kind": "function", "signature": "(notes)"}, {"_type": "tag", "name": "getSelectedNotebookId", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function getSelectedNotebookId() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    id: crypto?.randomUUID ? crypto.randomUUID() : Math.random().toString(36).slice(2),$/", "language": "JavaScript", "kind": "property", "scope": "createNotebook.nb", "scopeKind": "class"}, {"_type": "tag", "name": "importAllData", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function importAllData(json, { mode = 'merge' } = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(json, { mode = 'merge' } = {})"}, {"_type": "tag", "name": "listActiveNotes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function listActiveNotes(notebookId) {$/", "language": "JavaScript", "kind": "function", "signature": "(notebookId)"}, {"_type": "tag", "name": "listArchivedNotes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function listArchivedNotes(notebookId) {$/", "language": "JavaScript", "kind": "function", "signature": "(notebookId)"}, {"_type": "tag", "name": "listNotebooks", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function listNotebooks() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "listNotes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function listNotes(notebookId) {$/", "language": "JavaScript", "kind": "function", "signature": "(notebookId)"}, {"_type": "tag", "name": "mergeData", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^function mergeData(existing, incoming) {$/", "language": "JavaScript", "kind": "function", "signature": "(existing, incoming)"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    name: trimmed,$/", "language": "JavaScript", "kind": "property", "scope": "createNotebook.nb", "scopeKind": "class"}, {"_type": "tag", "name": "nb", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^  const nb = {$/", "language": "JavaScript", "kind": "class", "scope": "createNotebook", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^function normalizeNote(n) {$/", "language": "JavaScript", "kind": "function", "signature": "(n)"}, {"_type": "tag", "name": "normalizeNotebook", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^function normalizeNotebook(n) {$/", "language": "JavaScript", "kind": "function", "signature": "(n)"}, {"_type": "tag", "name": "notebooks", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    notebooks: Array.isArray(notebooks) ? notebooks : [],$/", "language": "JavaScript", "kind": "property", "scope": "exportAllData.payload", "scopeKind": "class"}, {"_type": "tag", "name": "notes", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    notes: Array.isArray(notes) ? notes : [],$/", "language": "JavaScript", "kind": "property", "scope": "exportAllData.payload", "scopeKind": "class"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^  const payload = {$/", "language": "JavaScript", "kind": "class", "scope": "exportAllData", "scopeKind": "class"}, {"_type": "tag", "name": "readJSON", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^function readJSON(key, fallback) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, fallback)"}, {"_type": "tag", "name": "renameNotebook", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function renameNotebook(id, name) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, name)"}, {"_type": "tag", "name": "schemaVersion", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    schemaVersion: EXPORT_SCHEMA_VERSION,$/", "language": "JavaScript", "kind": "property", "scope": "exportAllData.payload", "scopeKind": "class"}, {"_type": "tag", "name": "selectedNotebookId", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    selectedNotebookId,$/", "language": "JavaScript", "kind": "field", "scope": "exportAllData.payload", "scopeKind": "class"}, {"_type": "tag", "name": "setSelectedNotebookId", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function setSelectedNotebookId(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "unarchiveNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function unarchiveNote(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "updateNote", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^export function updateNote(id, patch) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, patch)"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^    updatedAt: new Date().toISOString(),$/", "language": "JavaScript", "kind": "property", "scope": "createNotebook.nb", "scopeKind": "class"}, {"_type": "tag", "name": "validateImportSchema", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^function validateImportSchema(json) {$/", "language": "JavaScript", "kind": "function", "signature": "(json)"}, {"_type": "tag", "name": "writeJSON", "path": "/home/kavia/workspace/code-generation/simple-notes-manager-46153-46162/notes_app_frontend/src/lib/storage.js", "pattern": "/^function writeJSON(key, value) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, value)"}], "hash": "efd802799ccb91151488e09ae172dc65", "format-version": 4, "code-base-name": "notes_app_frontend", "filename": "notes_app_frontend/src/lib/storage.js", "fields": [{"name": "createdAt: new Date().toISOString(),", "scope": "createNotebook.nb", "scopeKind": "class", "description": "unavailable"}, {"name": "exportedAt: new Date().toISOString(),", "scope": "exportAllData.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "id: crypto?.randomUUID ? crypto.randomUUID() : Math.random().toString(36).slice(2),", "scope": "createNotebook.nb", "scopeKind": "class", "description": "unavailable"}, {"name": "name: trimmed,", "scope": "createNotebook.nb", "scopeKind": "class", "description": "unavailable"}, {"name": "notebooks: Array.isArray(notebooks) ? notebooks : [],", "scope": "exportAllData.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "notes: Array.isArray(notes) ? notes : [],", "scope": "exportAllData.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "schemaVersion: EXPORT_SCHEMA_VERSION,", "scope": "exportAllData.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "selectedNotebookId,", "scope": "exportAllData.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "updatedAt: new Date().toISOString(),", "scope": "createNotebook.nb", "scopeKind": "class", "description": "unavailable"}]}